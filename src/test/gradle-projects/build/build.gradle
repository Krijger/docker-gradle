buildscript {
  repositories {
    maven { url = "file://${project.projectDir}/../../../../build/repoForTests" }
    mavenCentral()
  }
  dependencies {
    classpath group: 'nl.qkrijger.gradle', name: 'docker-gradle', version: '0.1-TEST'
  }
}
apply from: '../../gradle-plugins/docker-extended-for-tests.gradle'

task('inspectImage', description: 'Inspect the image. If this works, we know it has been built.', type: Exec) {
  commandLine 'docker', 'inspect', "${-> project.docker.imageId}"
}

tasks.buildImage.finalizedBy tasks.inspectImage
tasks.cleanup.mustRunAfter tasks.inspectImage
